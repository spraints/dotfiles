#!/usr/bin/env ruby

conflicts = `git status --porcelain -z`
  .split("\0")
  .map { |l| [l[0], l[1], l[3..]] }
  .select { |x, y, _| (x == "U" && y == "U") || (x == "A" && y == "A") }
  .map { |_, _, fn| fn }
if conflicts.empty?
  puts "no conflicts!"
  exit 0
end
puts "found conflicts, editing these files:", conflicts.map { |fn| "- #{fn}" }
exec "nvim", *conflicts unless conflicts.empty?
